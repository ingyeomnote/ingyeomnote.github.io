**로직 중 에러가 발생했을 때 아래와 같은 화면이 나오도록 구현하였다. 잘못 구현된 부분을 [원인]에 기술하고(5점), 이를 정상적으로 작동할 수 있도록 [조치내용]에 수정(5점)하시오. (10점)**



<Servlet에서 처리한 코드 내용 중 일부>

request.setAttribute("msg", "로그인 실패");

request.getRequestDispatcher("WEB-INF/views/common/errorPage.jsp").forward(request, response);

![img](https://iei.or.kr/upload/editor/images/2021/3/20210326142510984623ac-a0d6-4c39-a91d-87aed174f248.png)

scriptlet으로 msg에 대한 값을 받아주지 않았다.

10번째 줄보다 위에 아래와 같은 scriptlet 추가

<% String msg = (String)request.getAttribute("msg"); %>



**아래의 내용과 같이 구현하였더니 WEB-INF/views/notice/noticeList.jsp에서 NullPointerException이 발생하였다. 문제 상황을 [원인](10점)에 기술하고, 이를 알맞게 고친 코드를 [조치내용](15점)에 작성하시오. (25점)**



<NoticeListServlet 중 일부>

![img](https://iei.or.kr/upload/editor/images/2021/3/20210326142546e51224d3-e230-48c6-a007-42dfeb152502.PNG)

![img](https://khmain.or.kr/upload/editor/images/2021/3/202103261425463325aa61-d653-4e55-8f35-248819ee6c33.PNG)

Servlet에서 view로 list 값을 보내지 않았음

request.setAttribute("list", list); 코드를 if문 안에 기술

---

**아래와 같은 boardUpdateForm.jsp에서 게시글 수정하기 버튼을 눌러 성공 시 게시글 상세 페이지를 보여주는 "/bdetail" Servlet을 실행하고 실패시 "views/common/errorPage.jsp"에 "게시글 수정 실패"라는 메세지를 넣어 포워딩하는 기능을 구현하시오.**



아래 form 태그에서 전달되는 값을 통해 BoardUpdateServlet에 기재해야 할 내용을 [원인](15점)에 기술하고 BoardService의 updateBoard() 메소드와 BoardDao의 updateBoard() 메소드를 [조치내용](25점)에 기술하시오.



[boardUpdateForm.jsp 코드 부분]

<%@ page language="java" contentType="text/html; charset=UTF-8"

pageEncoding="UTF-8" import="java.util.ArrayList, model.vo.*"%>

<%

Board b = (Board) request.getAttribute("board");

%>

<!DOCTYPE html>

<html>

<head>

<meta charset="UTF-8">

<title>Insert title here</title>

</head>

<body>

<div align="center">

<form action="<%=request.getContextPath()%>/update.bo" method="post">

<table>

<input type="hidden" value="<%=b.getbId()%>" name="bId">

<tr>

<td>제목</td>

<td><input type="text" name="title"

value="<%=b.getbTitle()%>"></td>

<td>작성자</td>

<td><input type="text" name="writer"

value="<%=b.getbWriter()%>" readonly></td>

</tr>

<tr>

<td>내용</td>

</tr>

<tr>

<td colspan="4"><textarea name="content" cols="60" rows="15"

style="resize: none;"><%=b.getbContent()%></textarea></td>

</tr>

</table>

<div align="center">

<button type="button" onclick="javascript:history.back();">취소</button>

<button id="submit" type="submit">수정하기</button>

</div>

</form>

</div>

</body>

</html>

---

나 

request.setCharacterEncoding("UTF-8");

​		response.setContentType("text/html; charset=UTF-8");

​		

​		String writer = request.getParameter("writer");

​		String title = request.getParameter("title");

​		String content = request.getParameter("content");

​		

​		BoardDto dto = new BoardDto(0, writer, title, content, null);

​		BoardBiz biz = new BoardBiz();

​		int res = biz.insert(dto);

​		if(res > 0) {

​			RequestDispatcher dispatch = request.getRequestDispatcher(path);

​			dispatch.forward(request, response);

​		}

---

package controller;



import java.io.IOException;



import javax.servlet.ServletException;

import javax.servlet.annotation.WebServlet;

import javax.servlet.http.HttpServlet;

import javax.servlet.http.HttpServletRequest;

import javax.servlet.http.HttpServletResponse;



import model.service.BoardService;

import model.vo.Board;



/**

\* Servlet implementation class BoardUpdateServlet

*/

@WebServlet("/update.bo")

public class BoardUpdateServlet extends HttpServlet {

private static final long serialVersionUID = 1L;



/**

\* @see HttpServlet#HttpServlet()

*/

public BoardUpdateServlet() {

super();

// TODO Auto-generated constructor stub

}



/**

\* @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)

*/

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

request.setCharacterEncoding("UTF-8");



int bId = Integer.parseInt(request.getParameter("bId"));



Board board = new Board();

board.setbId(bId);

board.setbTitle(request.getParameter("title"));

board.setbWriter(request.getParameter("writer"));

board.setbContent(request.getParameter("content"));



BoardService service = new BoardService();



int result = service.updateBoard(board);



if(result > 0) {

request.setAttribute("bId", bId);

request.getRequestDispatcher("detail.bo").forward(request, response);

} else {

request.setAttribute("msg", "게시글 수정에 실패했습니다.");

request.getRequestDispatcher("views/common/errorPage.jsp").forward(request, response);

}

}



/**

\* @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)

*/

protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

// TODO Auto-generated method stub

doGet(request, response);

}



}

---

나;

public int updateBoard(BoardDto dto){



  Connection con = getConnection();

​		String sql = " UPDATE BOARD "

​				  + " SET TITLE = ?, WRITER = ?, CONTENT = ? "

​				  + " WHERE BID = ? ";

​		PreparedStatement pstm = null;

​		int res = 0;

​		

​		try {

​			pstm = con.prepareStatement(sql);

​			pstm.setString(1, dto.getTitle());

 pstm.setString(2, dto.getWriter());

pstm.setString(3, dto.getContent());

​			pstm.setInt(4, dto.getBId());

​			

​			res = pstm.executeUpdate();

​			

​			if(res > 0) {

​				commit(con);

​			}

​		} catch (SQLException e) {

​			e.printStackTrace();

​		}finally {

​			close(pstm, con);

​		}

​		

​		return res;

}

---

// BoardService의 updateBoard()

public int updateBoard(Board board) {

Connection conn = getConnection();



int result = new BoardDao().updateBoard(conn, board);



if (result > 0) {

commit(conn);

} else {

rollback(conn);

}



close(conn);



return result;

}



// BoardDao의 updateDao()

public int updateBoard(Connection conn, Board board) {

PreparedStatement pstmt = null;

int result = 0;



String query = "UPDATE BOARD SET BTITLE=?, BWRITER=?, BCONTENT=? WHERE BID=?";



try {

pstmt = conn.prepareStatement(query);

pstmt.setString(1, board.getbTitle());

pstmt.setString(2, board.getbWriter());

pstmt.setString(3, board.getbContent());

pstmt.setInt(4, board.getbId());



result = pstmt.executeUpdate();

} catch(SQLException e) {

e.printStackTrace();

}finally {

close(pstmt);

}



return result;

}